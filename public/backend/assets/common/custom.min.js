(function($){"use strict";$(document).ready((function(){window.addEventListener("load",formValidation(),!1),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$(document).on("change",".file-preview",(function(){var previewDiv=$(this).attr("data-previewDiv");if(previewDiv&&($("#"+previewDiv).html(""),this.files&&this.files[0])){$("#"+previewDiv).html("Loading...");var reader=new FileReader;this.files[0].size>5e6?(input.value="",$("#"+previewDiv).html("")):(reader.onload=function(e){$("#"+previewDiv).html('<img src="'+e.target.result+'" class="form-preview-image img-responsive img-rounded  "  style="height: 8rem !important; width: 15rem !important"/>')},reader.readAsDataURL(this.files[0]))}})),$(document).on("click",".photo-library-page",(function(){let action=$(this).attr("href");return window.open(action,"_blank","width=1000,height=600,scrollbars=yes,menubar=no,status=yes,resizable=yes,screenx=100,screeny=10"),!1})),$(document).on("click",".delete-button",(function(){const thisAction=$(this);let action=thisAction.attr("data-action"),callBackFuncStatus=0;thisAction.attr("data-callback")&&(callBackFuncStatus=1),Swal.fire({title:"Do you want to delete?",confirmButtonText:"Yes",showDenyButton:!0,denyButtonText:"No"}).then((result=>{result.isConfirmed&&$.ajax({url:action,beforeSend:function(xhr){xhr.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},type:"DELETE",dataType:"json",success:function(response){if($(".dataTable").length&&$(".dataTable").DataTable().ajax.reload(),success_alert(response.message,response.title),1==callBackFuncStatus){let callBackFunc=eval(thisAction.attr("data-callback"));"function"==typeof callBackFunc&&callBackFunc(response,thisAction)}},error:function(response){let data=response.responseJSON;error_alert(data.message,data.title)}})}))})),$(document).on("click",".update-status-button",(function(){const thisAction=$(this);let action=thisAction.attr("data-action"),update_status=thisAction.attr("data-update_status");Swal.fire({title:"Do you want to update status?",confirmButtonText:"Yes",showDenyButton:!0,denyButtonText:"No"}).then((result=>{result.isConfirmed&&$.ajax({url:action,beforeSend:function(xhr){xhr.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},type:"PATCH",data:{status:update_status},dataType:"json",success:function(response){success_alert(response.message,response.title),thisAction.parent().html(response.data)},error:function(response){let data=response.responseJSON;error_alert(data.message,data.title)}})}))})),$(document).on("click",".photo-library-element",(function(){let thumb_image=$(this).attr("data-thumb_image"),actual_image_name=$(this).attr("data-actual_image_name"),caption=$(this).attr("data-caption"),div_id=($(this).attr("data-id"),$("#photo_library_div_id").val());var img=`<img class="img-responsive img-thumbnail image-library-preview" src="${thumb_image}" alt="${caption}"/>`;window.opener.document.getElementById(`photo-library-preview${div_id}`).innerHTML=img,window.opener.document.getElementById(`image_alt${div_id}`).value=caption,window.opener.document.getElementById(`image_title${div_id}`).value=caption,window.opener.document.getElementById(`photo_library_name${div_id}`).value=actual_image_name,window.close()})),$(document).on("click",".show-common-modal",(function(){$("#"+$(this).attr("data-modal_id")).modal("show")})),$(document).on("click",".cke_dialog_close_button, .cke_dialog_ui_button",(function(){Swal.close()}))}))})(jQuery);var base_url=$('meta[name="base-url"]').attr("content");let exceptName=["_token","_method"];function ajaxSubmit(e,form){e.preventDefault();let resetValue=!0;e.target.getAttribute("data-resetvalue")&&(resetValue=e.target.getAttribute("data-resetvalue"));let identifire=e.submitter,buttonValue=identifire.innerHTML;for(var instance in $(e.currentTarget.submit).val("Wait.."),CKEDITOR.instances)CKEDITOR.instances[instance].updateElement();var action=form.attr("action"),CallBackFunction=eval(form.attr("data")),formAction=e.target,formData=new FormData(formAction);formData.set("action_button_name",e.submitter.value),identifire.innerHTML='<div class="spinner-border spinner-border-sm" role="status">\n    <span class="visually-hidden">Loading...</span>\n    </div>',$.ajax({type:"POST",url:action,processData:!1,contentType:!1,cache:!1,dataType:"json",data:formData,async:!1,success:function(response){if(removeFormValidation(form,formData,resetValue),1==response.success){if($("#addForm").removeClass("was-validated"),success_alert(response.message,response.title),void 0!==response.data){let values=response.data;for(const fieldName in values)if(values.hasOwnProperty(fieldName)){const value=values[fieldName];form.find(`input[name='old_${fieldName}']`).length&&form.find(`input[name='old_${fieldName}']`).val(value)}}"function"==typeof CallBackFunction&&(response.hasOwnProperty("data"),CallBackFunction(response))}else"exist"==response.success?warning_alert(response.message,response.title):error_alert(response.message,response.title);setTimeout((()=>{identifire.innerHTML=buttonValue,$(`#${form.attr("id")}`).removeClass("was-validated")}),1e3)},error:function(response){removeFormValidation(form,formData,!1,!1);let data=response.responseJSON;if(error_alert(data.message,data.title),void 0!==data.errors)for(let fieldName in data.errors)if(data.errors.hasOwnProperty(fieldName)){const errorMessages=data.errors[fieldName];if(form.find(`input[name='${fieldName}']`).length){form.find(`input[name='${fieldName}']`).addClass("is-invalid");let currentErrorMessage="";errorMessages.forEach((errorMessage=>{currentErrorMessage=errorMessage})),form.find(`input[name='${fieldName}']`).parent().find(".invalid-feedback").html(currentErrorMessage)}else if(form.find(`#${fieldName}`).length){form.find(`#${fieldName}`).addClass("is-invalid");let currentErrorMessage="";errorMessages.forEach((errorMessage=>{currentErrorMessage=errorMessage})),form.find(`#${fieldName}`).parent().find(".invalid-feedback").html(currentErrorMessage)}}setTimeout((()=>{identifire.innerHTML=buttonValue}),1e3)}})}function success_alert(text,title=null,timer=5e3){toastr.success(text,title,{timeOut:timer})}function warning_alert(text,title=null,timer=5e3){toastr.warning(text,title,{timeOut:timer})}function error_alert(text,title=null,timer=5e3){toastr.error(text,title,{timeOut:timer})}function removeFormValidation(form,formData,resetValue=!1,resetSelectValue=!0){for(var instance in form.removeClass("was-validated"),CKEDITOR.instances)CKEDITOR.instances[instance].setData("");form.find(".form-preview-image").remove(),resetSelectValue&&(form.find(":checkbox").filter(":checked").each((function(){$(this).prop("checked",!1)})),form.find("select").each((function(){$(this).find("option:selected").prop("selected",!1),$(this).trigger("change")})),form.find("textarea").val("")),form.find(":input, select").each((function(){var elementType=this.tagName.toLowerCase();if("input"===elementType){var inputName=(inputObject=$(this)).attr("name"),inputType=inputObject.attr("type");["radio","checkbox"].includes(inputType)?["radio"].includes(inputType)&&resetSelectValue&&inputObject.prop("checked",!1):(form.find(`input[name='${inputName}']`).removeClass("is-invalid"),form.find(`input[name='${inputName}']`).parent().find(".invalid-feedback").html(""),1!=resetValue||exceptName.includes(inputName)||form.find(`input[name='${inputName}']`).val(""))}else if("select"===elementType){var inputObject,inputId=(inputObject=$(this)).attr("id");form.find(`#${inputId}`).removeClass("is-invalid"),form.find(`#${inputId}`).parent().find(".invalid-feedback").html("")}}))}function setFormValue(route,form,formData){return $.ajax({type:"get",url:route,processData:!1,contentType:!1,cache:!1,dataType:"json",async:!1}).then((response=>{let formValue=response.data;removeFormValidation(form,formData);for(const pair of formData.entries())if(fieldName=pair[0],fieldType=pair[1],!exceptName.includes(fieldName)){if(1==form.find(`input[name='old_${fieldName}']`).length&&form.find(`input[name='old_${fieldName}']`).val(formValue[fieldName]),form.find(`input[name='${fieldName}']`).hasClass("file-preview")&&formValue[fieldName]&&1==form.find(`#preview_file_${fieldName}`).length&&form.find(`#preview_file_${fieldName}`).html(`<img src="${base_url+"/storage/"+formValue[fieldName]}"  class="form-preview-image img-responsive img-rounded"/>`),form.find(`input[type='radio'][name='${fieldName}']`).length);else if(form.find(`textarea[name='${fieldName}']`).length)form.find(`textarea[name='${fieldName}']`).val(formValue[fieldName]);else if(form.find(`input[name='${fieldName}']`).length){const currentInput=form.find(`input[name='${fieldName}']`);"file"!==currentInput.attr("type")&&currentInput.val(formValue[fieldName])}}return form.find("input[type='radio'], select").each((function(){var elementType=this.tagName.toLowerCase(),inputName=$(this).attr("name"),inputObject=$(this);if("select"==elementType){let fieldname=inputObject.attr("data-fieldname");fieldname||(fieldname=inputName);let fieldid=inputObject.attr("data-fieldid");fieldid||(fieldid="id"),inputName.includes("[")&&inputName.includes("]")?formValue[fieldname]&&(formValue[fieldname].map((function(dataValue){$('select[name="'+inputName+'"] option[value="'+dataValue[fieldid]+'"]').prop("selected",!0)})),inputObject.trigger("change")):formValue[fieldname]&&($(this).map((function(dataValue){$('select[name="'+inputName+'"] option[value="'+formValue[fieldname]+'"]').prop("selected",!0)})),$(this).trigger("change"))}else $(`input[type='radio'][name=${inputName}]`)&&$(`input[type='radio'][name=${inputName}][value='${formValue[inputName]}']`).prop("checked",!0)})),formValue})).catch((function(response){let data=response.responseJSON;return data&&void 0!==data.message&&void 0!==data.title&&error_alert(data.message,data.title),data}))}function getAjaxData(route){return $.ajax({type:"get",url:route,processData:!1,contentType:!1,cache:!1,dataType:"json",async:!1}).then((response=>response.data)).catch((function(response){let data=response.responseJSON;return error_alert(data.message,data.title),data}))}function formValidation(){var forms=document.getElementsByClassName("needs-validation");Array.prototype.filter.call(forms,(function(form){form.addEventListener("submit",(function(event){event.preventDefault(),event.stopPropagation();var inputFields=form.querySelectorAll("input[required]");Array.from(inputFields).forEach((function(inputField){inputField.checkValidity()?inputField.classList.remove("is-invalid"):inputField.classList.add("is-invalid")})),form.classList.add("was-validated"),!1===form.checkValidity()?(warning_alert("Please fulfill all required fields."),$(this).find(".actionBtn").prop("disabled",!1)):($(this).find(".actionBtn").prop("disabled",!0),ajaxSubmit(event,$(this)),$(this).find(".actionBtn").prop("disabled",!1))}),!1)}))}function setAlertMessage(response,type=null){"success"==type||1==response.success?success_alert(response.message,response.title):"warning"==type||"exist"==response.success?warning_alert(response.message,response.title):"error"!=type&&0!=response.success||error_alert(response.message,response.title)}